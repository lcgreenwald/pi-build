#!/bin/bash

#This script will install the latest version of hamlib-1.0
#and then install hamlib 4.3
#https://github.com/km4ack/pi-build/issues/296
#20210805 KM4ACK

#Give this patch a unique name. A good idea is
#to give it the application name that is being 
#patched followed by the date. ie FLDIDI20210805

PATCHNAME=hamlib4.3-20210905

PATCHFILE=$HOME/.config/patch
touch $PATCHFILE
###############################
#Patch script commands go here#
###############################
clear;echo;echo
echo "installing libusb library"
sudo apt install libudev-dev
cd $HOME/Downloads
wget https://sourceforge.net/projects/libusb/files/libusb-1.0/libusb-1.0.24/libusb-1.0.24.tar.bz2
tar -xf libusb-1.0.24.tar.bz2
cd libusb-1.0.24
./configure
make
sudo make install


cd $HOME/Downloads
wget https://github.com/Hamlib/Hamlib/releases/download/4.3/hamlib-4.3.tar.gz
tar -xf hamlib-4.3.tar.gz
cd hamlib-4.3
./configure
make
sudo make install
sudo ldconfig



#############################################
#write patch name to a file so we can       #
#look and see if it has been applied before.#
#This is checked by the patch-menu script   #
#before running the patch                   #
#############################################
echo "$PATCHNAME" >> $PATCHFILE